<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Machine Learning for Everyone!</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="chapter_1.html"><strong aria-hidden="true">1.</strong> Quick Introduction</a></li><li class="chapter-item expanded "><a href="chapter_2.html"><strong aria-hidden="true">2.</strong> Basic Linear Algebra needed</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="chapter_2-ref.html"><strong aria-hidden="true">2.1.</strong> References</a></li></ol></li><li class="chapter-item expanded "><a href="ml_models.html"><strong aria-hidden="true">3.</strong> ML Models</a></li><li class="chapter-item expanded "><a href="dl.html"><strong aria-hidden="true">4.</strong> Deep Learning</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="nn.html"><strong aria-hidden="true">4.1.</strong> Neural Network</a></li><li class="chapter-item expanded "><a href="grad_descent.html"><strong aria-hidden="true">4.2.</strong> Gradient descent</a></li><li class="chapter-item expanded "><a href="back_propagation.html"><strong aria-hidden="true">4.3.</strong> Back Propagation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="bp_calc.html"><strong aria-hidden="true">4.3.1.</strong> Calculus</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="tf.html"><strong aria-hidden="true">5.</strong> Tensorflow</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tfjs.html"><strong aria-hidden="true">5.1.</strong> TensorFlow.js</a></li></ol></li><li class="chapter-item expanded "><a href="torch.html"><strong aria-hidden="true">6.</strong> PyTorch</a></li><li class="chapter-item expanded "><a href="chapter_7.html"><strong aria-hidden="true">7.</strong> Transformers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="bert.html"><strong aria-hidden="true">7.1.</strong> BERT</a></li><li class="chapter-item expanded "><a href="GPT.html"><strong aria-hidden="true">7.2.</strong> GPT</a></li><li class="chapter-item expanded "><a href="T5.html"><strong aria-hidden="true">7.3.</strong> T5</a></li><li class="chapter-item expanded "><a href="copilot.html"><strong aria-hidden="true">7.4.</strong> GitHub Copilot</a></li><li class="chapter-item expanded "><a href="chapter_7_ref.html"><strong aria-hidden="true">7.5.</strong> References</a></li></ol></li><li class="chapter-item expanded "><a href="sf_e.html"><strong aria-hidden="true">8.</strong> Salesforce Einstein</a></li><li class="chapter-item expanded "><a href="gcp.html"><strong aria-hidden="true">9.</strong> Google Cloud Platform</a></li><li class="chapter-item expanded "><a href="pu.html"><strong aria-hidden="true">10.</strong> Processing Units</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="cpu.html"><strong aria-hidden="true">10.1.</strong> CPU</a></li><li class="chapter-item expanded "><a href="gpu.html"><strong aria-hidden="true">10.2.</strong> GPU</a></li><li class="chapter-item expanded "><a href="tpu.html"><strong aria-hidden="true">10.3.</strong> TPU</a></li></ol></li><li class="chapter-item expanded "><a href="ml_pl.html"><strong aria-hidden="true">11.</strong> ML Pipelines</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tfs.html"><strong aria-hidden="true">11.1.</strong> TensorFlow Serving</a></li><li class="chapter-item expanded "><a href="tfx.html"><strong aria-hidden="true">11.2.</strong> TensorFlow Extended</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="apache_airflow.html"><strong aria-hidden="true">11.2.1.</strong> Apache Airflow</a></li><li class="chapter-item expanded "><a href="apache_beam.html"><strong aria-hidden="true">11.2.2.</strong> Apache Beam</a></li><li class="chapter-item expanded "><a href="kubeflow.html"><strong aria-hidden="true">11.2.3.</strong> Kubeflow</a></li></ol></li><li class="chapter-item expanded "><a href="automl.html"><strong aria-hidden="true">11.3.</strong> AutoML</a></li></ol></li><li class="chapter-item expanded "><a href="speedup.html"><strong aria-hidden="true">12.</strong> Speedup</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="jax.html"><strong aria-hidden="true">12.1.</strong> JAX</a></li><li class="chapter-item expanded "><a href="closure.html"><strong aria-hidden="true">12.2.</strong> Closures and Decorators</a></li><li class="chapter-item expanded "><a href="jax_ref.html"><strong aria-hidden="true">12.3.</strong> References</a></li></ol></li><li class="chapter-item expanded "><a href="openai.html"><strong aria-hidden="true">13.</strong> OpenAI</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="openai-api.html"><strong aria-hidden="true">13.1.</strong> API</a></li><li class="chapter-item expanded "><a href="openai-chat.html"><strong aria-hidden="true">13.2.</strong> Chat</a></li><li class="chapter-item expanded "><a href="openai-summarize.html"><strong aria-hidden="true">13.3.</strong> Summarize</a></li><li class="chapter-item expanded "><a href="openai-tldr.html"><strong aria-hidden="true">13.4.</strong> TLDR</a></li><li class="chapter-item expanded "><a href="open-translate.html"><strong aria-hidden="true">13.5.</strong> Translate</a></li><li class="chapter-item expanded "><a href="openai-codex.html"><strong aria-hidden="true">13.6.</strong> Codex</a></li></ol></li><li class="chapter-item expanded "><a href="tools.html"><strong aria-hidden="true">14.</strong> Tools</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Machine Learning for Everyone!</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="chapter-1--quick-introduction"><a class="header" href="#chapter-1--quick-introduction">Chapter 1 : Quick Introduction</a></h1>
<ul>
<li>In traditional programming we start with <strong>data</strong> and <strong>rules</strong> to apply on the data to get <strong>answers</strong>. This style of programming can't bring answers for problems predicting a type of cat in the cat picture.</li>
</ul>
<p>As shown in the demo below, user provides a image of the cat, the application predicts type of the cat in that image with a confidence (probability) with help of Machine Learning.</p>
<p><img src="img/1/img-rec-1.mov.webm.gif" alt="Image Recognition - 1 " /></p>
<p>To build this kind of solution using traditional programming, we may have to write too many rules or sometimes this problem is not easily solvable by our traditional programming. Here comes our hero <strong>Machine Learning</strong> to our rescue us!</p>
<h2 id="what-is-special-about-machine-learning-"><a class="header" href="#what-is-special-about-machine-learning-">What is special about Machine Learning ?</a></h2>
<p>How long it will take to write the code for <strong>Solving Rubik’s Cube with a single Robot Hand</strong> using our traditional programming? </p>
<iframe width="720" height="480" src="https://www.youtube.com/embed/kVmp0uGtShk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chapter-2---basic-linear-algebra-needed-for-ml"><a class="header" href="#chapter-2---basic-linear-algebra-needed-for-ml">Chapter 2 - Basic Linear Algebra needed for ML</a></h1>
<p>As we know computer are comfortable in dealing with numbers and perform fast operations on those numbers to provide us the results we are interested in. But in our real world we deal with <strong>things</strong> like <em>words, sentences and images</em>. This creates an <em>impedance mismatch</em>. So obvious solution will be to solve this mismatch is by representing our <strong>things</strong> in numbers, let us call this as <strong>Data Representations</strong>.</p>
<p><strong>Linear Algebra</strong> what we learned in our high school math class comes to save us here!</p>
<p>In this chapter, we will have a friendly introduction to <strong>Linear Algebra</strong>. </p>
<p>If you did not have a chance to learn <strong>Linear Algebra</strong> in your high school, do not worry, I will try to explain in a <em>simplest possible way</em> to understand the <em>Data Representations</em> concepts so we can do Machine Learning work.</p>
<hr />
<p><em>&quot;Simplicity is the ultimate sophistication&quot;</em> - <a href="https://en.wikipedia.org/wiki/Leonardo_da_Vinci">Leonardo da Vinci</a></p>
<hr />
<h2 id="let-us-use-vectors-for-data-representations"><a class="header" href="#let-us-use-vectors-for-data-representations">Let us use Vectors for Data Representations</a></h2>
<p>Ok, what is a <strong>Vector</strong>?</p>
<ul>
<li>Vector is one Dimensional Array of numbers</li>
<li>It has magnitude (value) and direction</li>
</ul>
<p><img src="img/2/vector.png" alt="vector" /></p>
<ul>
<li>Example vector with 3 entries</li>
</ul>
<pre><code>v1 = [1, 2, 3]

</code></pre>
<p>When we say <em>n-dimensional vector space</em> we mean this space consists of all vector with <em>n</em> entries.
In our vector with 3 entries, <em>3-dimensional vector space</em> will consist of all the vectors with <em>3</em> entries.</p>
<p>Another name vector space is <strong>feature</strong>, let me explain that in few moments...</p>
<h2 id="how-you-can-draw-a-point-3d-space"><a class="header" href="#how-you-can-draw-a-point-3d-space">How you can draw a point 3D space</a></h2>
<pre><code class="language-py">from mpl_toolkits import mplot3d
import numpy as np
import matplotlib.pyplot as plt

# width by height here are 10 inches by  10 inches
fig = plt.figure(figsize=(10,10))

# 3d projection 
# with position (pos) of subplot as num-of-rows:1, num-of-cols:1, index-of-subplot:1
# If no positional arguments are passed, defaults to (1, 1, 1).

ax = fig.add_subplot(111, projection='3d')

# plot a point
ax.scatter(2,3,4)
plt.show()
</code></pre>
<p><img src="img/2/3d-plot.png" alt="3d plot" /></p>
<h2 id="what-is-a-feature-vector"><a class="header" href="#what-is-a-feature-vector">What is a feature Vector?</a></h2>
<p>Entries of the feature vectors represent <strong>features</strong> of the thing (object) this vector is used to represent.</p>
<p>Example:
Assume the thing (object) has 3 features: <em>Color, Heaviness and Shape</em>:</p>
<ol>
<li><strong>Color</strong> = 2
<ul>
<li>say number 1 means it is Red </li>
<li>say number 2 means it is Green</li>
<li>say number 3 means it is Blue</li>
</ul>
</li>
<li><strong>Heaviness</strong> : 2
<ul>
<li>say number 1 means it is light</li>
<li>say number 2 means it is medium</li>
<li>say number 3 means it is heavy</li>
<li>say number 4 means it is super heavy</li>
</ul>
</li>
<li><strong>Shape</strong> : 1
<ul>
<li>say number 1 means it is circle</li>
<li>say number 2 means it is rectangle</li>
<li>say number 3 means it is square</li>
<li>say number 4 means it is cube</li>
</ul>
</li>
</ol>
<p>So this object with <em>Color: Green, Heaviness: medium and Shape: circle</em> is represented (Data Representation) by this feature vector whose entries are:</p>
<pre><code> fv = [2,2,1]

</code></pre>
<p>Another example:</p>
<p>The object here is a <em>Patient</em> with:</p>
<ul>
<li>height: 64 inches,</li>
<li>weight: 131 pounds, </li>
<li>age: 23 years</li>
</ul>
<p>The <em>patient</em> vector <strong>p</strong>:</p>
<pre><code>p = [64, 131, 23]
</code></pre>
<p><img src="img/2/patient-vector.png" alt="Patient Vector" /></p>
<p>Now we understand how we can provide Data Representation using <strong>Feature Vectors</strong>.</p>
<h3 id="the-object-i-have-is-an-image-how-to-do-the-data-representations-for-this"><a class="header" href="#the-object-i-have-is-an-image-how-to-do-the-data-representations-for-this">The Object I have is an Image, how to do the Data Representations for this?</a></h3>
<ul>
<li>Black and White Images
<ul>
<li>Black: 0</li>
<li>White: 1</li>
<li>Gray: 0 to 255</li>
</ul>
</li>
</ul>
<p><img src="img/2/bw-img-2.png" alt="black and white image" /></p>
<h3 id="now-we-have-words-in-say-english-dictionary-how-to-do-the-data-representations-for-these-words"><a class="header" href="#now-we-have-words-in-say-english-dictionary-how-to-do-the-data-representations-for-these-words">Now we have words in say English dictionary, how to do the Data Representations for these words</a></h3>
<ul>
<li>
<p>Naive way:</p>
<ul>
<li>words are <strong>discrete</strong> and <strong>independent</strong> tokens</li>
<li>Build Dictionary or tokens </li>
</ul>
<pre><code class="language-py">['aardvark', ... 'king', ..., 'queen', ...]
</code></pre>
<ul>
<li>Since we need to convert words to numbers as part of our Data Representations, we can assign numbers to these words</li>
</ul>
<pre><code>[0, ...  11000, ... 12000, ...]

</code></pre>
<p>We will find out these large number are not well suited for ML. We can solve this by using a concept called <strong>one-hot-vector</strong></p>
<pre><code> [ [1,0,0,0,...], ... [0,0,0,0…1,0,0…], ... [0,0,0,,0,0…1,0,0…] ]      ]
</code></pre>
<p>These vectors have <strong>same dimensionality</strong> as the <strong>number-of-words in the dictionary</strong>.</p>
<p>Suppose the English has 100,000 word, the dimension of the one-hot-vector for each word will be 100,000. In that one-hot-vector only one entry in this vector will be <strong>1</strong> and all other entries will be <strong>0</strong>.</p>
<p><img src="img/2/one-hot-vector.png" alt="one-hot-vector" /></p>
<h4 id="disadvantages-with-one-hot-vector-way-of-data-representation"><a class="header" href="#disadvantages-with-one-hot-vector-way-of-data-representation">Disadvantages with one-hot-vector way of Data Representation</a></h4>
<ul>
<li>Very high dimensionality </li>
<li>Do not capture any world knowledge (like: Gender, Part-of-Speech...) about the words
<ul>
<li>example: <strong>king</strong> and <strong>queen</strong> are more in common with each other than <strong>aardvark</strong>
<ul>
<li>all of these token have <strong>90 degrees</strong> angles between them</li>
</ul>
</li>
</ul>
</li>
<li>Let us take a dictionary with only these 3 words</li>
</ul>
<pre><code>['aardvark', 'king', 'queen'] 

</code></pre>
<p><img src="img/2/word-rep-1.png" alt="word rep" /></p>
<ul>
<li>
<p>These 3 words in vectors in above 3-dimensional space</p>
</li>
<li>
<p>They are unit vectors aligned to axes</p>
</li>
<li>
<p>We need to find a way the words to occupy the entire this 3-dimensional space instead of perfectly aligning to the axes.</p>
</li>
<li>
<p>More useful Data Representation of words will be continuous vectors in the n-dimensional space</p>
<ul>
<li>This will allow <strong>aardvark</strong>, <strong>king</strong> and <strong>queen</strong> to flow anywhere in this 3-dimensional space. So their representations will be real-values like <strong>0.3</strong>, <strong>1.9</strong>, <strong>-0.4</strong> for <strong>aardvark</strong></li>
</ul>
<p><img src="img/2/num-rep-cont-1.png" alt="Word Continuous Representation" /></p>
</li>
<li>
<p>Representing world knowledge (like: Gender, Part-of-Speech...)</p>
</li>
<li>
<p>For example for <strong>queen</strong> [0.1, -0.3, 1.2,     -0.4, 0.02, 1.1,    -0.25, ... ]</p>
<ul>
<li>First 3 entires can represent the aspect of <strong>Gender</strong> for example</li>
<li>Next 3 entires can represent the aspect of <strong>Part-of-speech</strong> for example </li>
</ul>
</li>
<li>
<p>This mechanism will help us to express <strong>relationships between the words</strong> as equal to relative <strong>vector distance</strong></p>
</li>
</ul>
<p><img src="img/2/word-embedding-1.png" alt="word embedding" /></p>
<ul>
<li>For example, for Gender Dimension, <strong>king and queen</strong> should be far part as <strong>man and woman</strong>
<ul>
<li>In case of Part-of-speech dimensions, all these words should clustered together at a distance zero, since all of them are <strong>nouns</strong></li>
<li><strong>play</strong> (verb) and <strong>playful</strong> (adjective) should be at the same distance as <strong>joy</strong> and <strong>joyful</strong></li>
</ul>
</li>
</ul>
<h4 id="how-we-can-learn-useful-embedding-data-representations"><a class="header" href="#how-we-can-learn-useful-embedding-data-representations">How we can learn useful embedding (Data Representations)?</a></h4>
<ul>
<li>
<p><strong>Wikipedia</strong> comes to rescue us here! It is a reliable source of information we can use to learn the useful embeddings:</p>
<ul>
<li>has 28 billion words</li>
<li>309 languages</li>
</ul>
</li>
<li>
<p>If we look at the <strong>king</strong> and <strong>queen</strong> in Wikipedia, both them have lot of commonality</p>
<ul>
<li>They reference each other, includes common words like monarch</li>
<li>So Wikipedia has word knowledge we can extract to learn the useful embedding for us</li>
</ul>
</li>
<li>
<p>Wikipedia is freeform text</p>
<ul>
<li>Common practice
<ul>
<li>Unsupervised text data ---&gt; supervised task</li>
<li>we can ask the ML model to fill in the gaps and predict the next word as shown below:</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>King is the title given to male ______

monarch : 70%
body : 20%
dog: 10%

</code></pre>
<ul>
<li>The ML model could produce a probability distribution over the word in the vocabulary indicating which ones are more likely to follow the word given so far, in our case it is <strong>monarch</strong></li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="21-references"><a class="header" href="#21-references">2.1. References</a></h1>
<iframe width="720" height="480" src="https://www.youtube.com/embed/LlKAna21fLE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<ul>
<li><a href="https://mathinsight.org/vector_introduction">An introduction to vectors</a></li>
<li><a href="https://www.youtube.com/watch?v=LE3NfEULV6k">Transfer learning and Transformer models (ML Tech Talks)</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="3-ml-models"><a class="header" href="#3-ml-models">3. ML Models</a></h1>
<h2 id="simple-model"><a class="header" href="#simple-model">Simple model</a></h2>
<p>\( y = mx + b \)</p>
<pre><code> where
 m = slope (gradient)
 b = y-intercept

x is the independent variable
y is the dependent variable depends on m and b

</code></pre>
<h3 id="plotting-the-equation"><a class="header" href="#plotting-the-equation">Plotting the equation</a></h3>
<p>\( y = x*2 + 1 \)</p>
<p><img src="img/models/eqn-plotting-0.png" alt="ML Model plotting" /></p>
<pre><code class="language-py">import matplotlib.pyplot as plt
import numpy as np

# setup the plot size 10 inches by 10 inches
fig = plt.figure(figsize=(10,10))

# 1 row, 1 col, and index is 1
ax = fig.add_subplot(111)

# put grid in the plot
plt.grid()

# let us generate x values start from -5 to 5  with 100 samples
x = np.linspace(-5,5,100)
print ('Number of samples = {}' .format(len(x)))

ax.spines['left'].set_position('center')
ax.spines['bottom'].set_position('center')

ax.spines['right'].set_color('none')
ax.spines['top'].set_color('none')

# we need ticks at bottom and left
ax.xaxis.set_ticks_position('bottom')
ax.yaxis.set_ticks_position('left')

## our plot function
def plot_eqn(eqn,  color, label):
  plt.plot(x, eqn, color, label=label)
  # put legend at upper left cornor
  plt.legend(loc='upper left')

plot_eqn( x*2 + 1, '-r', 'eqn for x*2 + 1')
#plot_eqn( x*2 - 1, '-b', 'eqn for x*2 - 1')
#plot_eqn( x*2 - 3, ':b', 'eqn for x*2 - 3')
#plot_eqn( x*2 + 3, '--m', 'eqn for x*2 + 3')

## show our plot
plt.show()


</code></pre>
<h2 id="what-happens-when-we-train-a-ml-model-for-this-equation"><a class="header" href="#what-happens-when-we-train-a-ml-model-for-this-equation">What happens when we train a ML model for this equation?</a></h2>
<ul>
<li>We provide a training dataset with values for <strong>x</strong> and <strong>y</strong></li>
</ul>
<table><thead><tr><th>x</th><th>y</th></tr></thead><tbody>
<tr><td>2</td><td>5</td></tr>
<tr><td>1</td><td>3</td></tr>
<tr><td>7</td><td>15</td></tr>
<tr><td>...</td><td>...</td></tr>
</tbody></table>
<ul>
<li>During the training ML Model calculates the optimum value for <strong>m</strong> and <strong>b</strong> variables based on the training dataset we have provided</li>
<li>Once training completed, ML model is ready for predicting value for <strong>y</strong> for the given <strong>x</strong></li>
</ul>
<pre><code> You:   Hey, model my x value is 2, can you predict the value of y?
 Model: Sure, it is 5
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="4-deep-learning"><a class="header" href="#4-deep-learning">4. Deep Learning</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="neural-network"><a class="header" href="#neural-network">Neural Network</a></h1>
<iframe width="720" height="480" src="https://www.youtube.com/embed/aircAruvnKk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gradient-descent"><a class="header" href="#gradient-descent">Gradient descent</a></h1>
<iframe width="720" height="480" src="https://www.youtube.com/embed/IHZwWFHWa-w" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<div style="break-before: page; page-break-before: always;"></div><h1 id="back-propagation"><a class="header" href="#back-propagation">Back Propagation</a></h1>
<iframe width="720" height="480" src="https://www.youtube.com/embed/Ilg3gGewQ5U" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<div style="break-before: page; page-break-before: always;"></div><h1 id="calculus"><a class="header" href="#calculus">Calculus</a></h1>
<iframe width="720" height="480" src="https://www.youtube.com/embed/tIeHLnjs5U8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<div style="break-before: page; page-break-before: always;"></div><h1 id="5-tensorflow"><a class="header" href="#5-tensorflow">5. Tensorflow</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tensorflowjs"><a class="header" href="#tensorflowjs">TensorFlow.js</a></h1>
<p>TensorFlow.js (TFJS) is a library for machine learning in JavaScript.
Using TFJS you can develop ML models in JavaScript, and use ML directly in the browser or in Node.js.</p>
<h2 id="browser"><a class="header" href="#browser">Browser</a></h2>
<pre><code class="language-js">
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js&quot;&gt;&lt;/script&gt;

</code></pre>
<h2 id="nodejs"><a class="header" href="#nodejs">Node.js</a></h2>
<pre><code class="language-bash">
# install TensorFlow.js. using npm or yarn
yarn add @tensorflow/tfjs

# Install TensorFlow.js with native C++ bindings.
yarn add @tensorflow/tfjs-node

# if your system has a NVIDIA® GPU with CUDA support, use the GPU package even for higher performance.
yarn add @tensorflow/tfjs-node-gpu


</code></pre>
<pre><code class="language-js">
const tf = require('@tensorflow/tfjs');

// Optional Load the binding:
// Use '@tensorflow/tfjs-node-gpu' if running with GPU.
require('@tensorflow/tfjs-node');

// Train a simple model:
const model = tf.sequential();
model.add(tf.layers.dense({units: 100, activation: 'relu', inputShape: [10]}));
model.add(tf.layers.dense({units: 1, activation: 'linear'}));
model.compile({optimizer: 'sgd', loss: 'meanSquaredError'});

const xs = tf.randomNormal([100, 10]);
const ys = tf.randomNormal([100, 1]);

model.fit(xs, ys, {
  epochs: 100,
  callbacks: {
    onEpochEnd: (epoch, log) =&gt; console.log(`Epoch ${epoch}: loss = ${log.loss}`)
  }
});
  
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="6-pytorch"><a class="header" href="#6-pytorch">6. PyTorch</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="7-transformers"><a class="header" href="#7-transformers">7. Transformers</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bert"><a class="header" href="#bert">BERT</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gpt"><a class="header" href="#gpt">GPT</a></h1>
<p>Generative Pre-trained Transformer (GPT)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="t5"><a class="header" href="#t5">T5</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="github-copilot"><a class="header" href="#github-copilot">GitHub Copilot</a></h1>
<p>When we type this:</p>
<pre><code class="language-js">function calculateDaysBetweenDates(date1, date2) {

</code></pre>
<p>Copilot will complete this function:</p>
<pre><code class="language-js"> 
function calculateDaysBetweenDates(date1, date2) {

  // following lines are written by copilot
  var oneDay = 24 * 60 * 60 * 1000;
  var date1InMillis = date1.getTime();
  var date2InMillis = date2.getTime();
  var days = Math.round(Math.abs(date2InMillis - date1InMillis) / oneDay);
  return days;
}


</code></pre>
<p>\( \int x dx = \frac{x^2}{2} + C \)</p>
<p>\( \int y dy = \frac{y^3}{5} \)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="references"><a class="header" href="#references">References</a></h1>
<h2 id="transformers"><a class="header" href="#transformers">Transformers</a></h2>
<ul>
<li><a href="https://arxiv.org/pdf/1706.03762.pdf">Attention Is All You Need</a></li>
</ul>
<iframe width="720" height="480" src="https://www.youtube.com/embed/LE3NfEULV6k" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<hr />
<iframe width="720" height="480" src="https://www.youtube.com/embed/SZorAJ4I-sA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<ul>
<li><a href="https://www.youtube.com/watch?v=4Bdc55j80l8">Illustrated Guide to Transformers Neural Network: A step by step explanation</a></li>
<li><a href="https://www.youtube.com/watch?v=OyFJWRnt_AY">CS480/680 Lecture 19: Attention and Transformer Networks</a></li>
<li><a href="https://www.youtube.com/watch?v=S27pHKBEp30">LSTM is dead. Long Live Transformers!</a></li>
</ul>
<h2 id="open-ai"><a class="header" href="#open-ai">Open AI</a></h2>
<ul>
<li><a href="https://beta.openai.com/docs/introduction">OpenAI Documentation</a></li>
</ul>
<h3 id="codex"><a class="header" href="#codex">Codex</a></h3>
<ul>
<li>natural language to code</li>
<li><a href="https://www.youtube.com/watch?v=Zm9B-DvwOgw">Creating a Space Game with OpenAI Codex</a></li>
<li><a href="https://openai.com/blog/openai-codex/">OpenAI Codex</a></li>
</ul>
<h2 id="github-copilot-1"><a class="header" href="#github-copilot-1">Github Copilot</a></h2>
<ul>
<li>Trained on billions of lines of public code</li>
<li><a href="https://copilot.github.com/">Your AI pair programmer</a></li>
<li><a href="https://github.com/github/copilot-docs/blob/main/docs/visualstudiocode/gettingstarted.md#getting-started-with-github-copilot-in-visual-studio-code">VS Code extension</a></li>
</ul>
<h2 id="matplotlib"><a class="header" href="#matplotlib">Matplotlib</a></h2>
<p><a href="https://scriptverse.academy/tutorials/python-matplotlib-plot-function.html">Matplotlib: Plot a Function y=f(x) </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="9-salesforce-einstein"><a class="header" href="#9-salesforce-einstein">9. Salesforce Einstein</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="10-google-cloud-platform"><a class="header" href="#10-google-cloud-platform">10. Google Cloud Platform</a></h1>
<h2 id="dataflow"><a class="header" href="#dataflow">Dataflow</a></h2>
<p><img src="img/gcp/gcp-df-1.png" alt="GCP Dataflow" /></p>
<iframe width="720" height="480" src="https://www.youtube.com/embed/udKgN1_eThs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<div style="break-before: page; page-break-before: always;"></div><h1 id="11-processing-units"><a class="header" href="#11-processing-units">11. Processing Units</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cpu"><a class="header" href="#cpu">CPU</a></h1>
<p>CPU is constructed from millions of transistors.
It can have <strong>multiple processing cores</strong> and is commonly referred to as the brain of the computer. 
It is essential to all modern computing systems as it executes the commands and processes needed for your computer and operating system. 
The CPU is also important in determining how fast programs can run, from surfing the web to building spreadsheets.</p>
<p>The CPU is suited to a wide variety of workloads, especially those for which latency or per-core performance are important. A powerful execution engine, the CPU focuses its **smaller number of cores on individual tasks and on getting things done quickly. This makes it uniquely well equipped for jobs ranging from serial computing to running databases.</p>
<h2 id="intels-sandy-bridge-architecture--32-nm-micro-architecture"><a class="header" href="#intels-sandy-bridge-architecture--32-nm-micro-architecture">Intel's Sandy Bridge Architecture ( 32 nm micro architecture)</a></h2>
<p><img src="img/cpu/cpu-intel-sandy-bridge-1.png" alt="Intel Sandy Bridge CPU" /></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Sandy_Bridge#:%7E:text=Sandy%20Bridge%20is%20the%20codename,to%20Nehalem%20and%20Westmere%20microarchitecture.">Refer</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gpu"><a class="header" href="#gpu">GPU</a></h1>
<p>The GPU is a processor that is made up of many smaller and more <strong>specialized cores</strong>. By working together, these cores deliver <strong>massive performance</strong> when a processing task can be <strong>divided up</strong> and processed across these cores.</p>
<p>GPUs began as specialized <a href="https://en.wikipedia.org/wiki/Application-specific_integrated_circuit">ASICs - Application Specific Integrated Circuit</a> developed to <strong>accelerate specific 3D rendering tasks</strong>. </p>
<p>Over time, these fixed-function engines became more programmable and more flexible. While graphics and the increasingly lifelike visuals of today’s top games remain their principal function, GPUs have evolved to <strong>become more general-purpose parallel processors as well</strong>, handling a growing range of applications.</p>
<p>Initially GPUs were solving computer <strong>graphics</strong> related problems in Gaming
The General Purpose GPU (GPGPU) plays a vital role in the deep learning and parallel computing.</p>
<p><img src="img/gpu/NVIDIA-GPU-arch.png" alt="NIVIDA GPU" /></p>
<h3 id="what-is-cuda"><a class="header" href="#what-is-cuda">What is CUDA?</a></h3>
<p>Compute Unified Device Architecture (<a href="https://developer.nvidia.com/blog/cuda-refresher-getting-started-with-cuda/">CUDA</a>) is is a parallel computing platform developed by NVIDIA. It enables software programs to perform calculations using both the CPU and GPU.</p>
<h2 id="what-about-cpu"><a class="header" href="#what-about-cpu">What about CPU?</a></h2>
<p>CPU is constructed from millions of transistors.
It can have <strong>multiple processing cores</strong> and is commonly referred to as the brain of the computer. 
It is essential to all modern computing systems as it executes the commands and processes needed for your computer and operating system. 
The CPU is also important in determining how fast programs can run, from surfing the web to building spreadsheets.</p>
<p>The CPU is suited to a wide variety of workloads, especially those for which latency or per-core performance are important. A powerful execution engine, the CPU focuses its **smaller number of cores on individual tasks and on getting things done quickly. This makes it uniquely well equipped for jobs ranging from serial computing to running databases.</p>
<p><img src="img/cpu/cpu-intel-sandy-bridge-1.png" alt="Intel Sandy Bridge CPU" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tpu---tensor-processing-units"><a class="header" href="#tpu---tensor-processing-units">TPU - Tensor Processing Units</a></h1>
<p><a href="https://cloud.google.com/tpu/docs/tpus">TPUs</a> are Google’s custom-developed application-specific integrated circuits (ASICs) used to accelerate machine learning workloads.</p>
<p>Designed from the ground up with the benefit of Google’s deep experience and leadership in machine learning.</p>
<p>Enable us to run our machine learning workloads on <strong>Google’s TPU accelerator hardware</strong> using <strong>TensorFlow</strong></p>
<p>Designed for maximum performance and flexibility to help researchers, developers, and businesses to build TensorFlow compute clusters that can leverage <strong>CPUs, GPUs, and TPUs</strong>.</p>
<p>High-level <strong>TensorFlow APIs</strong> help us to get models running on the Cloud TPU hardware.</p>
<h2 id="advantages-for-using-tpus"><a class="header" href="#advantages-for-using-tpus">Advantages for using TPUs</a></h2>
<ul>
<li>
<p>Cloud TPU resources accelerate the performance of <strong>linear algebra computation</strong>, which is used heavily in machine learning applications.</p>
</li>
<li>
<p>TPUs <strong>minimize</strong> the <strong>time-to-accuracy</strong> when you <strong>train large, complex neural network models</strong>. Weeks to hours (150 times faster)</p>
<ul>
<li>Models that previously took <strong>weeks to train</strong> on other hardware platforms can converge in <strong>hours on TPUs</strong>.</li>
</ul>
</li>
</ul>
<h2 id="tpu-v3"><a class="header" href="#tpu-v3">TPU v3</a></h2>
<p>A <a href="https://cloud.google.com/tpu/docs/system-architecture-tpu-vm">TPU v3</a> board contains four TPU chips and 32 GiB of HBM. Each TPU chip contains two cores. Each core has a MXU, a vector unit, and a scalar unit.</p>
<p><img src="https://cloud.google.com/tpu/docs/images/tpu-v3-layout.png" alt="TPU architecture" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="11-ml-pipelines"><a class="header" href="#11-ml-pipelines">11. ML Pipelines</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tensorflow-serving"><a class="header" href="#tensorflow-serving">TensorFlow Serving</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tensorflow-extended"><a class="header" href="#tensorflow-extended">TensorFlow Extended</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="apache-airflow"><a class="header" href="#apache-airflow">Apache Airflow</a></h1>
<p>Airflow is a platform to programmatically author, schedule and monitor workflows.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="apache-beam"><a class="header" href="#apache-beam">Apache Beam</a></h1>
<p>Apache Bean help us to implement <strong>batch and streaming data processing jobs</strong> that run on any execution engine.</p>
<p><img src="img/apachebeam/beam-1.webp" alt="Apache Beam" /></p>
<iframe width="720" height="480" src="https://www.youtube.com/embed/udKgN1_eThs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<div style="break-before: page; page-break-before: always;"></div><h1 id="kubeflow"><a class="header" href="#kubeflow">Kubeflow</a></h1>
<p>The Kubeflow project is dedicated to making <strong>deployments of machine learning (ML) workflows</strong> on <strong>Kubernetes</strong> simple, portable and scalable.</p>
<p><img src="img/kubeflow/kubeflow-arch-1.svg" alt="Kubeflow Arch" /></p>
<h2 id="kubernetes"><a class="header" href="#kubernetes">Kubernetes</a></h2>
<p>Kubernetes is an open-source <strong>container-orchestration system</strong> for automating computer application </p>
<ul>
<li>deployment</li>
<li>scaling</li>
<li>management</li>
</ul>
<p>It was originally designed by Google and is now maintained by the Cloud Native Computing Foundation.</p>
<h2 id="references-1"><a class="header" href="#references-1">References</a></h2>
<ul>
<li><a href="https://www.kubeflow.org/docs/started/introduction/">Kubeflow home</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="automl"><a class="header" href="#automl">AutoML</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="12-speedup"><a class="header" href="#12-speedup">12. Speedup</a></h1>
<p>In this chapter we will see the ways to speed up Machine Learning</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="12-jax"><a class="header" href="#12-jax">12. JAX</a></h1>
<p><img src="https://raw.githubusercontent.com/google/jax/main/images/jax_logo_250px.png" alt="JAX" /></p>
<p><a href="https://github.com/google/jax">JAX</a> is a new library from <a href="https://research.google/">Google Research</a>. 
JAX can automatically differentiate native Python and Numpy functions.</p>
<ul>
<li>Loops</li>
<li>Branches</li>
<li>Recursion </li>
<li><a href="closure.html">Closures</a></li>
<li>Can take Derivative of Derivatives
<ul>
<li>Supports <strong>reverse mode differentiation</strong>, also known as [Back Propagation] using Grad function</li>
<li>Supports <strong>forward mode differentiation</strong></li>
</ul>
</li>
</ul>
<h2 id="xla"><a class="header" href="#xla">XLA</a></h2>
<p><a href="https://www.tensorflow.org/xla">XLA</a> is <strong>Accelerated Linear Algebra</strong>. </p>
<ul>
<li>
<p>It is a <strong>domain-specific compiler</strong> for <strong>linear algebra</strong> that can <strong>accelerate TensorFlow models</strong> with potentially <strong>no source code changes</strong>.</p>
</li>
<li>
<p>Performs optimizations like:</p>
<ul>
<li><strong>Fusing</strong> operations together (something like consolidation) so the intermediate results do not have to written out the memory. Instead it get <strong>streamed</strong> into next operation.</li>
<li>This enable faster and more efficient processing</li>
</ul>
<p>This is some what <strong>crudely</strong> equal to nodejs stream:
- Refer: TableauCRM CLI using this stream concept, where it loads data from a Oracle SQL Query results directly into Tableau CRM dataset
- <a href="https://github.com/mohan-chinnappan-n/cli-dx/blob/master/db/ora2ea.md">refer: sfdx mohanc:ea:dataset:loadFromOra</a></p>
<pre><code class="language-py"> def model (x, y, z):
     return tf.reduce_sum( x + y * z)
</code></pre>
</li>
</ul>
<p>JAX uses XLA to compile and run our Numpy program on <a href="https://www.intel.com/content/www/us/en/products/docs/processors/what-is-a-gpu.html">GPUs</a> and <a href="https://cloud.google.com/tpu/docs/tpus">TPUs</a></p>
<p>JAX uses JIT (just-in-time) compile of custom functions into XLA optimized kernels using decorator <code>@jit </code></p>
<pre><code class="language-py">
@jit # jit decorator
def update(params, x, y):
    grads = gard(loss)(params, x, y)
    return [ (w - step_size * dw, b - step_size * db) for (w, b), (dw, db) in zip (params, grads)]

</code></pre>
<h2 id="pmap"><a class="header" href="#pmap">pmap</a></h2>
<ul>
<li>JAX applies pmap (<a href="https://jax.readthedocs.io/en/latest/jax.html#parallelization-pmap">Parallel Map</a>) replicating computations across multiple cores
<img src="img/jax/jax-pmap.png" alt="pmap" /></li>
</ul>
<h2 id="autograd"><a class="header" href="#autograd">Autograd</a></h2>
<p>Autograd (https://github.com/hips/autograd) can automatically differentiate native <strong>Python and Numpy</strong> code.</p>
<h3 id="functions-available-for-the-transformations"><a class="header" href="#functions-available-for-the-transformations">Functions available for the transformations</a></h3>
<ul>
<li>grad</li>
<li>jit</li>
<li>pmap</li>
<li>vmap - automatic vectorization
<ul>
<li>allowing us to turn a function which can handle only <strong>one data point</strong> into a function which can handle <strong>batch of these data points</strong> of any size with just one wrapper function <em>vmap</em></li>
</ul>
</li>
</ul>
<h3 id="sample---mnist"><a class="header" href="#sample---mnist"><a href="https://colab.research.google.com/github/google/jax/blob/master/docs/notebooks/neural_network_with_tfds_data.ipynb">Sample - MNIST </a></a></h3>
<ul>
<li><a href="http://yann.lecun.com/exdb/mnist/">MIST Database</a></li>
</ul>
<pre><code class="language-py">
import jax.numpy as jnp
from jax import grad, vmap, jit


def predict(params, inputs):
  for W, b in params:
    outputs = jnp.dot(inputs, W) + b
    inputs = jnp.tanh(outputs)
  return outputs

def loss (params, batch):
  inputs, targets = batch
  preds = predict(params, inputs)
  return jnp.sum( (preds - targets) **2 ) # SME


gradient_fun = jit(grad(loss))
preexample_grads = vmap(grad(loss), in_axes=(None, 0))

</code></pre>
<h3 id="key-ideas"><a class="header" href="#key-ideas">Key Ideas</a></h3>
<ul>
<li>Python code is traced into an Intermediate Representation (IR)
<ul>
<li>IR can be transformed (automatic differentiation) </li>
<li>IR enables domain-specific compilation (XLA - Accelerated Linear Algebra)</li>
</ul>
</li>
<li>Has very powerful transforms
<ul>
<li>grad</li>
<li>jit</li>
<li>vmap</li>
<li>pmap</li>
</ul>
</li>
<li>Python's dynamism makes this possible
<ul>
<li>JAX makes use of this dynamism and evaluates a function's behavior by calling it on a <strong>tracer</strong> value</li>
</ul>
</li>
</ul>
<pre><code class="language-py">def sum(x):
    return x + 2

class ShapedArray(object):
    def __add__ (self, other):
        self.record_computation(&quot;add&quot;, self, other)
        return ShapedArray(self.shape, self.dtype) # dtype is like float32

sum( ShapedArray( (2,2), float32 ))


</code></pre>
<p><img src="img/jax/jax-ir-1.png" alt="jax-IR" /></p>
<p>With this IR, JAX knows how to do the transforms like:</p>
<ul>
<li>grad</li>
<li>jit</li>
<li>vmap</li>
<li>pmap</li>
</ul>
<p><img src="img/jax/jax-ir-2.png" alt="jax-IR" /></p>
<p><img src="img/jax/jax-ir-3.png" alt="jax-IR" /></p>
<pre><code class="language-py">TF_CPP_MIN_LOG_LEVEL=0 

import jax
import jax.numpy as jnp

global_list = []

def log2(x):
  global_list.append(x)
  ln_x = jnp.log(x)
  ln_2 = jnp.log(2.0)
  return ln_x / ln_2

print( jax.make_jaxpr(log2)(3.0) )

</code></pre>
<ul>
<li><a href="https://jax.readthedocs.io/en/latest/jax-101/02-jitting.html#how-jax-transforms-work">Document</a></li>
<li>Output </li>
</ul>
<pre><code>{ lambda ; a:f32[]. let
    b:f32[] = log a
    c:f32[] = log 2.0
    d:f32[] = div b c
  in (d,) 
}

</code></pre>
<h3 id="jake-on-jax"><a class="header" href="#jake-on-jax">Jake on JAX</a></h3>
<iframe width="720" height="480" src="https://www.youtube.com/embed/WdTeDXsOSj4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<iframe width="720" height="480" src="https://www.youtube.com/embed/0mVmRHMaOJ4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<iframe width="720" height="480" src="https://www.youtube.com/embed/fuAyUQcVzTY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<div style="break-before: page; page-break-before: always;"></div><h1 id="closures-and-decorators"><a class="header" href="#closures-and-decorators">Closures and Decorators</a></h1>
<h2 id="python-closures"><a class="header" href="#python-closures">Python Closures</a></h2>
<p>Let us explain <strong>closure</strong> by an example:</p>
<ul>
<li><a href="https://www.programiz.com/python-programming/closure">Refer</a></li>
</ul>
<pre><code class="language-py">
# This is the outer enclosing function
def print_msg(msg):

    def printer():
        # This is the nested function
        print(msg)

    return printer  # returns the nested function


# Now let's try calling this function.
another = print_msg(&quot;Hello&quot;)
another()
# Output: Hello
</code></pre>
<p>This technique by which <strong>some data</strong> in our case &quot;Hello&quot; gets attached to the code - <em>another()</em> is called <strong>closure</strong> in Python.</p>
<p>Three characteristics of a Python closure are: </p>
<ol>
<li>it is a nested function, in our example: <em>printer()</em> </li>
<li>it has access to a free variable in outer scope, in our example: <em>msg</em>. </li>
<li>it is returned from the <strong>enclosing</strong> function, in our example: <em>print_msg()</em></li>
</ol>
<pre><code>

``
# Python Decorators make an extensive use of closures 

</code></pre>
<h2 id="python-decorators"><a class="header" href="#python-decorators">Python Decorators</a></h2>
<ul>
<li><a href="https://www.programiz.com/python-programming/decorator">Refer</a></li>
</ul>
<p>A decorator takes in a function, adds some functionality and returns it. </p>
<pre><code class="language-py">#  a decorator takes in a function, adds some functionality and returns it.

# takes in function to be decorated
def make_pretty(func):
    def inner():
        print(&quot;I got decorated&quot;) # getting decorated
        func() # back to the given function
    return inner


def ordinary():
    print(&quot;I am ordinary&quot;)

</code></pre>
<pre><code class="language-py"># will print:  I am ordinary

ordinary()

</code></pre>
<pre><code class="language-py">decorated = make_pretty(ordinary)
decorated() 
&quot;&quot;&quot; will print: 
    I got decorated
    I am ordinary
&quot;&quot;&quot;

# decorator function (make_pretty) has added
##  some new functionality to the original function (ordinary)

</code></pre>
<pre><code class="language-py"># annoation way
@make_pretty # syntactic sugar
def ordinary():
    print(&quot;I am ordinary&quot;)

</code></pre>
<pre><code class="language-py">iam_special = ordinary()
&quot;&quot;&quot; will print: 
    I got decorated
    I am ordinary
&quot;&quot;&quot;

</code></pre>
<h3 id="decorating-functions-with-parameters"><a class="header" href="#decorating-functions-with-parameters">Decorating functions with parameters</a></h3>
<pre><code class="language-py"># Decorating functions with parameters

def smart_divide(func):
    def inner(a, b):
        print(&quot;I am going to divide&quot;, a, &quot;and&quot;, b)
        if b == 0:
            print(&quot;Whoops! cannot divide by zero&quot;)
            return

        return func(a, b)
    return inner


@smart_divide
def divide(a, b):
    print(a/b)
</code></pre>
<pre><code class="language-py">
divide(10,2)

&quot;&quot;&quot; will print: 
    I am going to divide 10 and 2
    5.0
&quot;&quot;&quot;
</code></pre>
<pre><code class="language-py">
divide(10,0)

&quot;&quot;&quot; will print: 
    I am going to divide 10 and 0
    Whoops! cannot divide by zero
&quot;&quot;&quot;

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="references-2"><a class="header" href="#references-2">References</a></h1>
<iframe width="720" height="480" src="https://www.youtube.com/embed/0mVmRHMaOJ4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<ul>
<li><a href="https://realpython.com/primer-on-python-decorators/">Primer on Python Decorators</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="13-openai"><a class="header" href="#13-openai">13. OpenAI</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="openai-api"><a class="header" href="#openai-api">OpenAI API</a></h1>
<h3 id="completion"><a class="header" href="#completion">Completion</a></h3>
<pre><code class="language-bash">curl https://api.openai.com/v1/engines/davinci/completions \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer YOUR_API_KEY \
  -d '{
  &quot;prompt&quot;: &quot;Once upon a time&quot;,
  &quot;max_tokens&quot;: 5
}'

</code></pre>
<ul>
<li>Result</li>
</ul>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;cmpl-4DmYlIcNgBh26avH8t5mMMWwgILGE&quot;,
  &quot;object&quot;: &quot;text_completion&quot;,
  &quot;created&quot;: 1639190275,
  &quot;model&quot;: &quot;davinci:2020-05-03&quot;,
  &quot;choices&quot;: [
    {
      &quot;text&quot;: &quot;, there was a software&quot;,
      &quot;index&quot;: 0,
      &quot;logprobs&quot;: null,
      &quot;finish_reason&quot;: &quot;length&quot;
    }
  ]
}

</code></pre>
<h3 id="search"><a class="header" href="#search">Search</a></h3>
<pre><code class="language-bash">curl https://api.openai.com/v1/engines/davinci/search \
  -H &quot;Content-Type: application/json&quot; \
  -H 'Authorization: Bearer YOUR_API_KEY' \
  -d '{
  &quot;documents&quot;: [&quot;White House&quot;, &quot;hospital&quot;, &quot;school&quot;],
  &quot;query&quot;: &quot;the president&quot;
}'
</code></pre>
<pre><code class="language-json">{
  &quot;object&quot;: &quot;list&quot;,
  &quot;data&quot;: [
    {
      &quot;object&quot;: &quot;search_result&quot;,
      &quot;document&quot;: 0,
      &quot;score&quot;: 215.56
    },
    {
      &quot;object&quot;: &quot;search_result&quot;,
      &quot;document&quot;: 1,
      &quot;score&quot;: 55.614
    },
    {
      &quot;object&quot;: &quot;search_result&quot;,
      &quot;document&quot;: 2,
      &quot;score&quot;: 40.932
    }
  ],
  &quot;model&quot;: &quot;davinci:2020-05-03&quot;
}

</code></pre>
<h3 id="create-classification"><a class="header" href="#create-classification">Create Classification</a></h3>
<pre><code class="language-bash">curl https://api.openai.com/v1/classifications \
  -X POST \
  -H &quot;Authorization: Bearer YOUR_API_KEY&quot; \
  -H 'Content-Type: application/json' \
  -d '{
    &quot;examples&quot;: [
      [&quot;A happy moment&quot;, &quot;Positive&quot;],
      [&quot;I am sad.&quot;, &quot;Negative&quot;],
      [&quot;I am feeling awesome&quot;, &quot;Positive&quot;]],
    &quot;query&quot;: &quot;It is a raining day :(&quot;,
    &quot;search_model&quot;: &quot;ada&quot;,
    &quot;model&quot;: &quot;curie&quot;,
    &quot;labels&quot;:[&quot;Positive&quot;, &quot;Negative&quot;, &quot;Neutral&quot;]
  }'

</code></pre>
<pre><code class="language-json">
{
  &quot;completion&quot;: &quot;cmpl-4DmdStcV7tC6o5VJnoihr4TDFHse4&quot;,
  &quot;label&quot;: &quot;Negative&quot;,
  &quot;model&quot;: &quot;curie:2020-05-03&quot;,
  &quot;object&quot;: &quot;classification&quot;,
  &quot;search_model&quot;: &quot;ada&quot;,
  &quot;selected_examples&quot;: [
    {
      &quot;document&quot;: 1,
      &quot;label&quot;: &quot;Negative&quot;,
      &quot;text&quot;: &quot;I am sad.&quot;
    },
    {
      &quot;document&quot;: 0,
      &quot;label&quot;: &quot;Positive&quot;,
      &quot;text&quot;: &quot;A happy moment&quot;
    },
    {
      &quot;document&quot;: 2,
      &quot;label&quot;: &quot;Positive&quot;,
      &quot;text&quot;: &quot;I am feeling awesome&quot;
    }
  ]
}


</code></pre>
<h3 id="answers"><a class="header" href="#answers">Answers</a></h3>
<pre><code class="language-bash">curl https://api.openai.com/v1/answers \
  -X POST \
  -H &quot;Authorization: Bearer YOUR_API_KEY&quot; \
  -H 'Content-Type: application/json' \
  -d '{
    &quot;documents&quot;: [&quot;Puppy A is happy.&quot;, &quot;Puppy B is sad.&quot;],
    &quot;question&quot;: &quot;which puppy is happy?&quot;,
    &quot;search_model&quot;: &quot;ada&quot;,
    &quot;model&quot;: &quot;curie&quot;,
    &quot;examples_context&quot;: &quot;In 2017, U.S. life expectancy was 78.6 years.&quot;,
    &quot;examples&quot;: [[&quot;What is human life expectancy in the United States?&quot;,&quot;78 years.&quot;]],
    &quot;max_tokens&quot;: 5,
    &quot;stop&quot;: [&quot;\n&quot;, &quot;&lt;|endoftext|&gt;&quot;]
  }'

</code></pre>
<pre><code class="language-json">{
&quot;answers&quot;: [
  &quot;puppy A.&quot;
],
&quot;completion&quot;: &quot;cmpl-4DmgSrZJ7sQx6lWRbaMyskSN68qCE&quot;,
&quot;model&quot;: &quot;curie:2020-05-03&quot;,
&quot;object&quot;: &quot;answer&quot;,
&quot;search_model&quot;: &quot;ada&quot;,
&quot;selected_documents&quot;: [
  {
    &quot;document&quot;: 0,
    &quot;text&quot;: &quot;Puppy A is happy. &quot;
  },
  {
    &quot;document&quot;: 1,
    &quot;text&quot;: &quot;Puppy B is sad. &quot;
  }
]
}

</code></pre>
<h3 id="list-files"><a class="header" href="#list-files">List Files</a></h3>
<pre><code class="language-bash">curl https://api.openai.com/v1/files \
  -H 'Authorization: Bearer YOUR_API_KEY'


</code></pre>
<pre><code class="language-json">{
  &quot;object&quot;: &quot;list&quot;,
  &quot;data&quot;: []
}

</code></pre>
<h3 id="upload-files"><a class="header" href="#upload-files">Upload Files</a></h3>
<pre><code class="language-bash">curl https://api.openai.com/v1/files \
  -H &quot;Authorization: Bearer YOUR_API_KEY&quot; \
  -F purpose=&quot;answers&quot; \
  -F file='@puppy.jsonl'

</code></pre>
<h3 id="delete-file"><a class="header" href="#delete-file">Delete File</a></h3>
<pre><code class="language-bash">curl https://api.openai.com/v1/files/file-XjGxS3KTG0uNmNOK362iJua3 \
  -X DELETE \
  -H 'Authorization: Bearer YOUR_API_KEY'

</code></pre>
<h3 id="retrieve-file-information"><a class="header" href="#retrieve-file-information">Retrieve File Information</a></h3>
<pre><code class="language-bash">curl https://api.openai.com/v1/files/file-XjGxS3KTG0uNmNOK362iJua3 \
  -H 'Authorization: Bearer YOUR_API_KEY'

</code></pre>
<h3 id="retrieve-file-content"><a class="header" href="#retrieve-file-content">Retrieve File Content</a></h3>
<pre><code class="language-bash">
curl https://api.openai.com/v1/files/file-XjGxS3KTG0uNmNOK362iJua3/content \
  -H 'Authorization: Bearer YOUR_API_KEY' &gt; file.jsonl


</code></pre>
<h3 id="fine-tunes"><a class="header" href="#fine-tunes">Fine Tunes</a></h3>
<ul>
<li>Manage fine-tuning jobs to tailor a model to your specific training data.</li>
</ul>
<pre><code class="language-bash">curl https://api.openai.com/v1/fine-tunes \
  -X POST \
  -H &quot;Content-Type: application/json&quot; \
  -H &quot;Authorization: Bearer YOUR_API_KEY&quot; \
  -d '{
  &quot;training_file&quot;: &quot;file-XGinujblHPwGLSztz8cPS8XY&quot;
}'

</code></pre>
<h3 id="list-fine-tunes"><a class="header" href="#list-fine-tunes">List fine-tunes</a></h3>
<pre><code class="language-bash">curl https://api.openai.com/v1/fine-tunes \
  -H 'Authorization: Bearer YOUR_API_KEY'

</code></pre>
<h3 id="list-fine-tune-information"><a class="header" href="#list-fine-tune-information">List fine-tune information</a></h3>
<pre><code class="language-bash">curl https://api.openai.com/v1/fine-tunes/ftjob-AF1WoRqd3aJAHsqc9NY7iL8F \
  -H &quot;Authorization: Bearer YOUR_API_KEY&quot;

</code></pre>
<h3 id="cancel-a-fine-tune"><a class="header" href="#cancel-a-fine-tune">Cancel a fine-tune</a></h3>
<pre><code class="language-bash">curl https://api.openai.com/v1/fine-tunes/ftjob-AF1WoRqd3aJAHsqc9NY7iL8F/cancel \
  -X POST \
  -H &quot;Authorization: Bearer YOUR_API_KEY&quot;

</code></pre>
<h3 id="list-fine-tune-events"><a class="header" href="#list-fine-tune-events">List fine-tune events</a></h3>
<pre><code class="language-bash">curl https://api.openai.com/v1/fine-tunes/ftjob-AF1WoRqd3aJAHsqc9NY7iL8F/events \
  -H &quot;Authorization: Bearer YOUR_API_KEY&quot;

</code></pre>
<h3 id="embeddings"><a class="header" href="#embeddings">Embeddings</a></h3>
<ul>
<li>Get a vector representation of a given input that can be easily consumed by machine learning models and algorithms.</li>
</ul>
<pre><code class="language-bash">curl https://api.openai.com/v1/engines/babbage-similarity/embeddings \
  -X POST \
  -H &quot;Authorization: Bearer YOUR_API_KEY&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d '{&quot;input&quot;: &quot;The food was delicious and the waiter...&quot;}' 

</code></pre>
<pre><code class="language-json">{
  &quot;object&quot;: &quot;list&quot;,
  &quot;data&quot;: [
    {
      &quot;object&quot;: &quot;embedding&quot;,
      &quot;embedding&quot;: [
        0.002866707742214203,
        0.01886799931526184,
        -0.03013569489121437,
        -0.004034548997879028,
        ...
      ]
     &quot;index&quot;: 0
    }
  ],
  &quot;model&quot;: &quot;babbage-similarity-model:2021-09-20&quot;
}

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chat"><a class="header" href="#chat">Chat</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="summarize"><a class="header" href="#summarize">Summarize</a></h1>
<video controls width="100%" height="100%">
    <source src="img/openai/openAI-summarize-1.webm" type="video/webm">
</video><div style="break-before: page; page-break-before: always;"></div><h1 id="tldr"><a class="header" href="#tldr">TLDR</a></h1>
<video controls width="100%" height="100%">
    <source src="img/openai/openAI-tldr-1.webm" type="video/webm">
</video><div style="break-before: page; page-break-before: always;"></div><h1 id="translate"><a class="header" href="#translate">Translate</a></h1>
<video controls width="100%" height="100%">
    <source src="img/openai/openAI-translate-en-fr-1.webm" type="video/webm">
</video>
<div style="break-before: page; page-break-before: always;"></div><h1 id="codex-1"><a class="header" href="#codex-1">Codex</a></h1>
<iframe width="720" height="480" src="https://www.youtube.com/embed/SGUCcjHTmGY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<iframe width="720" height="480" src="https://www.youtube.com/embed/Zm9B-DvwOgw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Ru5fQZ714x8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div style="break-before: page; page-break-before: always;"></div><h1 id="20-tools"><a class="header" href="#20-tools">20. Tools</a></h1>
<ul>
<li><a href="tablesgenerator.com/markdown_tables">Markdown Table Generator</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </body>
</html>
